<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{layout/layout}">
	<th:block layout:fragment="content">
		<div class="page-wrapper">
			<div class="container" id="container">
				<h2>My Activities</h2>
				<div class="ptag-container mb-2">
					<span>Today is the</span> 
					<span id="accuDate" class="text-primary fs-3"></span>
					<span>day since you subscribed to iFrame2.0.</span>
				</div>
			</div>

			<div class="container-xl mb-6">
				<div class="col-12">
					<div class="row row-cards">

						<div class="col-sm-12 col-lg-4">
							<div class="card card-sm">
								<div class="ribbon ribbon-top bg-primary">
									<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-login-2"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 8v-2a2 2 0 0 1 2 -2h7a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-7a2 2 0 0 1 -2 -2v-2" /><path d="M3 12h13l-3 -3" /><path d="M13 15l3 -3" /></svg>
								</div>

								<div class="card-body ms-3 me-3">
									<div class="col align-items-center mb-3">
										<span>
											Last login time :
										</span>
										<span id="lastLoginDtm" class="text-primary fs-3"></span>
									</div>
									<div class="col align-items-center mb-5">
										<span>
											You've logged in 
										</span>
										<span id="loginCntTotal" class="text-primary fs-3"></span>
										<span>
											times so far.
										</span>
									</div>
									
									<div id="chart-01" class="chart-sm"></div>

									<div class="col align-items-center mt-2">
										<span class="fs-5">Login trends in the last 30 days</span>
									</div>
																		
								</div>
							</div>
						</div>

						<div class="col-sm-12 col-lg-4">
							<div class="card card-sm">
								<div class="ribbon ribbon-top bg-success">
									<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-upload"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2" /><path d="M7 9l5 -5l5 5" /><path d="M12 4l0 12" /></svg>
								</div>

								<div class="card-body ms-3 me-3">
									<div class="col align-items-center mb-3">
										<span>
											Last upload time :
										</span>
										<span id="lastUploadDtm" class="text-success fs-3"></span>
									</div>
									<div class="col align-items-center mb-5">
										<span>
											You've uploaded 
										</span>
										<span id="uploadCntTotal" class="text-success fs-3"></span>
										<span>
											times so far.
										</span>
									</div>
									
									<div id="chart-02" class="chart-sm"></div>
									
									<div class="col align-items-center mt-2">
										<span class="fs-5">Upload trends in the last 30 days</span>
									</div>
									
								</div>
							</div>
						</div>


						<div class="col-sm-12 col-lg-4">
							<div class="card card-sm">
								<div class="ribbon ribbon-top bg-warning">
									<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-settings"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z" /><path d="M9 12a3 3 0 1 0 6 0a3 3 0 0 0 -6 0" /></svg>
								</div>

								<div class="card-body ms-3 me-3">
									<div class="col align-items-center mb-3">
										<span>
											Last run time :
										</span>
										<span id="lastBatDtm" class="text-warning fs-3"></span>
									</div>
									<div class="col align-items-center mb-5">
										<span>
											You've run 
										</span>
										<span id="batCntTotal" class="text-warning fs-3"></span>
										<span>
											times so far.
										</span>
									</div>
									
									<div id="chart-03" class="chart-sm"></div>

									<div class="col align-items-center mt-2">
										<span class="fs-5">Run trends in the last 30 days</span>
									</div>
									
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="container" id="container">
			<h2>My Account</h2>
				<div class="ptag-container mb-5">
					<span>You can change some information including password.</span> 
				</div>
			</div>
			<div class="container-xl mb-6">
				
			    <form id="companyInfoForm" name="companyInfoForm" method="post" action="/auth/adamsNewCs" autocomplete="off" onsubmit="return false;">
			    	<input type="hidden" th:name="${csrfParameterName}" th:value="${csrfToken}" />


						<div class="row">
							<div class="col-md-4">
								<div class="form-floating mb-2">
									<input type="text" th:value="${loginDTO.usrNm}" class="form-control" id="managerName" name="managerName" maxLength="50" placeholder="your name" autocomplete="off" disabled>
									<label for="managerName">your name</label>
								</div>
							</div>
							<div class="col-md-4">
								<div class="form-floating mb-2">
									<input type="text" class="form-control" id="managerTeam" name="managerTeam" maxLength="50" placeholder="your team name (or division, department etc.)" autocomplete="off" required>
									<label for="managerTeam">your team name (or division, department etc.)</label>
								</div>
							</div>
							<div class="col-md-4">
								<div class="form-floating mb-2">
									<input type="text" th:value="${loginDTO.usrPhNo}" class="form-control" id="managerPhone" name="managerPhone" maxLength="30" placeholder="ditect phone number (without -)" autocomplete="off" required>
									<label for="managerPhone">direct phone number (without -)</label>
								</div>
							</div>
						</div>

						<div class="row">
							<div class="col-md-4">
								<div class="form-floating mb-2">
									<input type="email" th:value="${loginDTO.usrId}" class="form-control" id="managerEmail" name="managerEmail" minLength="8" maxLength="50" placeholder="your@email.com" autocomplete="off" disabled>
									<label for="managerEmail">your@email.com</label>
								</div>
							</div>
							<div class="col-md-4">
								<div class="form-floating mb-2">
									<input type="password" class="form-control" id="usrPassword" name="usrPassword" minLength="8" maxLength="20" placeholder="your password" autocomplete="off" required>
									<label for="usrPassword">your password</label>
								</div>
							</div>
							<div class="col-md-4">
								<div class="form-floating mb-2">
									<input type="password" class="form-control" id="usrPasswordAgain" name="usrPasswordAgain" minLength="8" maxLength="20" placeholder="your password again" autocomplete="off" required>
									<label for="usrPasswordAgain">your password again</label>
								</div>
							</div>
						</div>

						<div class="row">
							<div class="col-md-4">
							</div>
							<div class="col-md-4">
								<div class="form-footer">
									<button id="updateButton" class="btn btn-secondary w-100" onclick="updateMyAccount()">Update</button>
								</div>
							</div>
							<div class="col-md-4">
							</div>
						</div>
 
    				</form>
				</div>

			</div>

		<script>
		
			/* var chart01; */			
			// @formatter:off
			document.addEventListener("DOMContentLoaded", function () {
				window.ApexCharts && (new ApexCharts(document.getElementById('chart-01'), {
					chart: {
						id: "chartId-01",
						type: "area",
						fontFamily: 'inherit',
						height: 60.0,
						sparkline: {
							enabled: true
						},
						animations: {
							enabled: false
						},
					},
					dataLabels: {
						enabled: false,
					},
					fill: {
						opacity: .16,
						type: 'solid'
					},
					stroke: {
		      			width: 3,
		      			lineCap: "round",
		      			curve: "smooth",
					},
					series: [{
						name: "count",
						data: []
					}],
					tooltip: {
						theme: 'dark'
					},
					grid: {
						strokeDashArray: 4,
					},
					xaxis: {
						labels: {
							padding: 0,
						},
						tooltip: {
							enabled: false
						},
						axisBorder: {
							show: false,
						},
						type: 'datetime',
					},
					yaxis: {
						labels: {
							padding: 4
						},
					},
					labels: [],
					colors: [tabler.getColor("primary")],
					legend: {
						show: false,
					},
				})).render();
			});
			// @formatter:on
		</script>


		<script>
			// @formatter:off
			document.addEventListener("DOMContentLoaded", function () {
				window.ApexCharts && (new ApexCharts(document.getElementById('chart-02'), {
					chart: {
						id: "chartId-02",
						type: "area",
						fontFamily: 'inherit',
						height: 60.0,
						sparkline: {
							enabled: true
						},
						animations: {
							enabled: false
						},
					},
					dataLabels: {
						enabled: false,
					},
					fill: {
						opacity: .16,
						type: 'solid'
					},
					stroke: {
		      			width: 3,
		      			lineCap: "round",
		      			curve: "smooth",
					},
					series: [{
						name: "count",
						data: []
					}],
					tooltip: {
						theme: 'dark'
					},
					grid: {
						strokeDashArray: 4,
					},
					xaxis: {
						labels: {
							padding: 0,
						},
						tooltip: {
							enabled: false
						},
						axisBorder: {
							show: false,
						},
						type: 'datetime',
					},
					yaxis: {
						labels: {
							padding: 4
						},
					},
					labels: [],
					colors: [tabler.getColor("success")],
					legend: {
						show: false,
					},
				})).render();
			});
			// @formatter:on
		</script>

		<script>
			// @formatter:off
			document.addEventListener("DOMContentLoaded", function () {
				window.ApexCharts && (new ApexCharts(document.getElementById('chart-03'), {
					chart: {
						id: "chartId-03",
						type: "area",
						fontFamily: 'inherit',
						height: 60.0,
						sparkline: {
							enabled: true
						},
						animations: {
							enabled: false
						},
					},
					dataLabels: {
						enabled: false,
					},
					fill: {
						opacity: .16,
						type: 'solid'
					},
					stroke: {
		      			width: 3,
		      			lineCap: "round",
		      			curve: "smooth",
					},
					series: [{
						name: "count",
						data: []
					}],
					tooltip: {
						theme: 'dark'
					},
					grid: {
						strokeDashArray: 4,
					},
					xaxis: {
						labels: {
							padding: 0,
						},
						tooltip: {
							enabled: false
						},
						axisBorder: {
							show: false,
						},
						type: 'datetime',
					},
					yaxis: {
						labels: {
							padding: 4
						},
					},
					labels: [],
					colors: [tabler.getColor("warning")],
					legend: {
						show: false,
					},
				})).render();
			});
			// @formatter:on
		</script>

		<script>
			$(document).ready(function () {
				console.log("Document is ready.");
				
				//화면 접속시 바로 조회
				main();
			});
			
			function main() {
				// 그리드 초기화 및 데이터 로드
				console.log("Initializing myPage...");
				
				// 그래프 초기화 및 데이터 로드 - ajax 공통 함수
				getAdamsRegDtmTotal((input = JSON.stringify({usrId: ""})));
				getAdamsLastLoginDtm((input = JSON.stringify({usrId: ""})));
				getAdamsLoginCntTotal((input = JSON.stringify({usrId: ""})));
				getAdamsMonthLoginCnt((input = JSON.stringify({usrId: ""})));
				
				getAdamsLastUploadDtm((input = JSON.stringify({usrId: ""})));
				getAdamsUploadCntTotal((input = JSON.stringify({usrId: ""})));
				getAdamsMonthUploadCnt((input = JSON.stringify({usrId: ""})));
				
				getAdamsLastBatDtm((input = JSON.stringify({usrId: ""})));
				getAdamsBatCntTotal((input = JSON.stringify({usrId: ""})));
				getAdamsMonthBatCnt((input = JSON.stringify({usrId: ""})));
			}
			
			/**
			* Transaction callback 함수
			**/
			function fn_callback(result){
				//console.log("fn_callback : " + result.id);
				if( result.resultCd == "S" ){
					switch (result.id){
						case "getAdamsRegDtmTotal" :
							fn_regDtmTotal(result.data);
							break;
						case "getAdamsLastLoginDtm" :
							fn_lastLoginDtm(result.data);
							break;
						case "getAdamsLoginCntTotal" :
							fn_loginCntTotal(result.data);
							break;
						case "getAdamsMonthLoginCnt" :
							fn_monthLoginCnt(result.data);
							break;
							
						case "getAdamsLastUploadDtm" :
							fn_lastUploadDtm(result.data);
							break;
						case "getAdamsUploadCntTotal" :
							fn_uploadCntTotal(result.data);
							break;
						case "getAdamsMonthUploadCnt" :
							fn_monthUploadCnt(result.data);
							break;
							
						case "getAdamsLastBatDtm" :
							fn_lastBatDtm(result.data);
							break;
						case "getAdamsBatCntTotal" :
							fn_batCntTotal(result.data);
							break;
						case "getAdamsMonthBatCnt" :
							fn_monthBatCnt(result.data);
							break;
						case "updateMyAccount" :
							break;
					}
				} else if( result.resultCd == "E") {
				} else {
					console.log("fn_callback result : ", result);
				}
			}
			
			function getAdamsRegDtmTotal(input) {
				// 계정 누적일 생성 수
				var option = {
					id: "getAdamsRegDtmTotal"
					, type: "post"
					, url: "/mypage/adamsRegDtmTotal"
					, async: true
					, dataType: "json"
					, contentType: "application/json; charset=utf-8"
					, data: input,
				};

				gf_Transaction(option, fn_callback);
			}

			function Cardinal2Ordinal(n)
			{
			    n = parseInt(n, 10);
			    const suffix = ['th', 'st', 'nd', 'rd'];
			    const mod100 = n % 100;
			    return n+(suffix[(mod100-20)%10] || suffix[mod100] || suffix[0]);
			}

			function fn_regDtmTotal(data) {
				
				if (data && data.regDtmTotal > 0){
					let regDtmTotal = data.regDtmTotal;
					
					if(regDtmTotal > 0){
						$("#accuDate").text(Cardinal2Ordinal(regDtmTotal).toLocaleString()).css("font-weight", "bold");
					}else {
						// No subscription info found
						$("#accuDate").text("1st").css("font-weight", "bold"); // accuDate 초기값은 1
					}
				}else if (data && data.regDtmTotal === 0) {
                    // No subscription info found
                    $("#accuDate").text("1st").css("font-weight", "bold");
                }
			}
			
			function getAdamsLastLoginDtm(input) {
				// 가장 최근에 로그인한 날짜
				var option = {
					id: "getAdamsLastLoginDtm"
					, type: "post"
					, url: "/mypage/adamsLastLoginDtm"
					, async: true
					, dataType: "json"
					, contentType: "application/json; charset=utf-8"
					, data: input,
				};

				gf_Transaction(option, fn_callback);
			}
			
			function fn_lastLoginDtm(data) {
				
				let formattedDate; // date 초기화 배열
				
				let now = new Date();
				formattedDate = now.getFullYear() + '-' +
								('0' + (now.getMonth() + 1)).slice(-2) + '-' +
				                ('0' + now.getDate()).slice(-2) + ' ' +
				                ('0' + now.getHours()).slice(-2) + ':' +
				                ('0' + now.getMinutes()).slice(-2) + ':' +
				                ('0' + now.getSeconds()).slice(-2);
				                
				if (data && data.lastLoginDtm){
					let lastLoginDtm = data.lastLoginDtm;
					
					if(lastLoginDtm){
						$("#lastLoginDtm").text(lastLoginDtm).css("font-weight", "bold");
					}else {
						// No subscription info found
						$("#lastLoginDtm").text(formattedDate).css("font-weight", "bold");
					}
				}else {
                    // No subscription info found
                    $("#lastLoginDtm").text(formattedDate).css("font-weight", "bold");
                }
			} 
			
			function getAdamsLoginCntTotal(input) {
				// 로그인 총 횟수
				var option = {
					id: "getAdamsLoginCntTotal"
					, type: "post"
					, url: "/mypage/adamsLoginCntTotal"
					, async: true
					, dataType: "json"
					, contentType: "application/json; charset=utf-8"
					, data: input,
				};

				gf_Transaction(option, fn_callback);
			}
			
			function fn_loginCntTotal(data){
				
				if (data && typeof data.loginCntTotal === "number"){
					let loginCntTotal = data.loginCntTotal;
					
					if(loginCntTotal >= 0){
						$("#loginCntTotal").text(loginCntTotal.toLocaleString()).css("font-weight", "bold");
					}else {
						// No subscription info found
						$("#loginCntTotal").text("0").css("font-weight", "bold");
					}
				}else {
                    // No subscription info found
                    $("#loginCntTotal").text("0").css("font-weight", "bold");
                }
			}
			
			function getAdamsMonthLoginCnt(input) {
				// (전날 기준) 30일간 일별 로그인 횟수
				var option = {
					id: "getAdamsMonthLoginCnt"
					, type: "post"
					, url: "/mypage/adamsMonthLoginCnt"
					, async: true
					, dataType: "json"
					, contentType: "application/json; charset=utf-8"
					, data: input,
				};

				gf_Transaction(option, fn_callback);
			}
			
			function fn_monthLoginCnt(data){
				
				if (data && data.length > 0) {
                    let accDtm = data[0].accDtm;
                    let loginCnt = data[0].loginCnt;
                    
                    if (accDtm && typeof loginCnt === 'number' && loginCnt >= 0) {
                    	// 차트를 위한 리스트 변환
						loginDtms = [], loginCnts = []
						
						data.forEach(item =>{
							loginDtms.push(item.accDtm);
							loginCnts.push(item.loginCnt);
						});
						
						// 차트 정보 업데이트							
						ApexCharts.exec('chartId-01', 'updateOptions', {
							series: [{
								name: "count",
								data: loginCnts
							}],
							labels: loginDtms,
						}, true, true);
						
					} else {
						// No positive values found
						console.error("Invalid month login count");
					}
				} else if (data && data.length === 0) {
                	// No subscription info found
                	console.error("Invalid month login count")
                }
			}
			
			function getAdamsLastUploadDtm(input) {
				// 가장 최근에 파일 업로드 했던 날짜
				var option = {
					id: "getAdamsLastUploadDtm"
					, type: "post"
					, url: "/mypage/adamsLastUploadDtm"
					, async: true
					, dataType: "json"
					, contentType: "application/json; charset=utf-8"
					, data: input,
				};

				gf_Transaction(option, fn_callback);
			}
			
			function fn_lastUploadDtm(data){
				
				if (data && data.lastUploadDtm){
					let lastUploadDtm = data.lastUploadDtm;
					
					if(lastUploadDtm){
						$("#lastUploadDtm").text(lastUploadDtm).css("font-weight", "bold");
					}else {
						// No subscription info found
						$("#lastUploadDtm").text("").css("font-weight", "bold");
					}
				}else {
                    // No subscription info found
                    $("#lastUploadDtm").text("").css("font-weight", "bold");
                }
			}
			
			function getAdamsUploadCntTotal(input) {
				// 파일 업로드 총 횟수
				var option = {
					id: "getAdamsUploadCntTotal"
					, type: "post"
					, url: "/mypage/adamsUploadCntTotal"
					, async: true
					, dataType: "json"
					, contentType: "application/json; charset=utf-8"
					, data: input,
				};
				
				gf_Transaction(option, fn_callback);
			}
			
			function fn_uploadCntTotal(data){
				
				if (data && typeof data.uploadCntTotal === "number"){
					let uploadCntTotal = data.uploadCntTotal;
					
					if(uploadCntTotal >= 0){
						$("#uploadCntTotal").text(uploadCntTotal.toLocaleString()).css("font-weight", "bold");
					}else {
						// No subscription info found
						$("#uploadCntTotal").text("0").css("font-weight", "bold");
					}
				}else {
                    // No subscription info found
                    $("#uploadCntTotal").text("0").css("font-weight", "bold");
                }
			}
			
			function getAdamsMonthUploadCnt(input) {
				// (전날 기준)30일간 일별 파일 업로드 횟수
				var option = {
					id: "getAdamsMonthUploadCnt"
					, type: "post"
					, url: "/mypage/adamsMonthUploadCnt"
					, async: true
					, dataType: "json"
					, contentType: "application/json; charset=utf-8"
					, data: input,
				};

				gf_Transaction(option, fn_callback);
			}
			
			function fn_monthUploadCnt(data){
				
				if (data && data.length > 0) {
                    let uploadStrDtm = data[0].uploadStrDtm;
                    let uploadCnt = data[0].uploadCnt;
                    
                    if (uploadStrDtm && typeof uploadCnt === 'number' && uploadCnt >= 0) {
                    	// 차트를 위한 리스트 변환
						uploadDtms = [], uploadCnts = []
						
						data.forEach(item =>{
							uploadDtms.push(item.uploadStrDtm);
							uploadCnts.push(item.uploadCnt);
						});
						
						// 차트 정보 업데이트							
						ApexCharts.exec('chartId-02', 'updateOptions', {
							series: [{
								name: "count",
								data: uploadCnts
							}],
							labels: uploadDtms,
						}, true, true);
						
					} else {
						// No positive values found
						console.error("Invalid month upload count graph");
					}
				} else if (data && data.length === 0) {
                	// No subscription info found
					console.error("Invalid month upload count graph");
                }
			}
			
			function getAdamsLastBatDtm(input) {
				// 가장 최근에 배치를 실행 했던 날짜
				var option = {
					id: "getAdamsLastBatDtm"
					, type: "post"
					, url: "/mypage/adamsLastBatDtm"
					, async: true
					, dataType: "json"
					, contentType: "application/json; charset=utf-8"
					, data: input,
				};

				gf_Transaction(option, fn_callback);
			}
			
			function fn_lastBatDtm(data){
			    
				if (data && data.lastBatDtm){
					let lastBatDtm = data.lastBatDtm;
					
					if(lastBatDtm){
						$("#lastBatDtm").text(lastBatDtm).css("font-weight", "bold");
					}else {
						// No subscription info found
						$("#lastBatDtm").text("").css("font-weight", "bold");
					}
				}else {
                    // No subscription info found
                    $("#lastBatDtm").text("").css("font-weight", "bold");
                }
			}
			
			function getAdamsBatCntTotal(input) {
				// 배치 실행 총 횟수
				var option = {
					id: "getAdamsBatCntTotal"
					, type: "post"
					, url: "/mypage/adamsBatCntTotal"
					, async: true
					, dataType: "json"
					, contentType: "application/json; charset=utf-8"
					, data: input,
				};

				gf_Transaction(option, fn_callback);
			}
			
			function fn_batCntTotal(data) {
				if (data && typeof data.batCntTotal === "number"){
					let batCntTotal = data.batCntTotal;
					
					if(batCntTotal >= 0){
						$("#batCntTotal").text(batCntTotal.toLocaleString()).css("font-weight", "bold");
					}else {
						// No subscription info found
						$("#batCntTotal").text("0").css("font-weight", "bold");
					}
				}else {
                    // No subscription info found
                    $("#batCntTotal").text("0").css("font-weight", "bold");
                }
			}
			
			function getAdamsMonthBatCnt(input) {
				// (전날 기준)30일간 일별 배치를 실행한 횟수
				var option = {
					id: "getAdamsMonthBatCnt"
					, type: "post"
					, url: "/mypage/adamsMonthBatCnt"
					, async: true
					, dataType: "json"
					, contentType: "application/json; charset=utf-8"
					, data: input,
				};

				gf_Transaction(option, fn_callback);
			}
			
			function fn_monthBatCnt(data) {
				if (data && data.length > 0) {
                    let batStrDtm = data[0].batStrDtm;
                    let batCnt = data[0].batCnt;
                    
                    if (batStrDtm && typeof batCnt === 'number' && batCnt >= 0) {
                    	// 차트를 위한 리스트 변환
						batDtms = [], batCnts = []
						
						data.forEach(item =>{
							batDtms.push(item.batStrDtm);
							batCnts.push(item.batCnt);
						});
						
						// 차트 정보 업데이트							
						ApexCharts.exec('chartId-03', 'updateOptions', {
							series: [{
								name: "count",
								data: batCnts
							}],
							labels: batDtms,
						}, true, true);
						
					} else {
						// No positive values found
						console.error("Invalid month batch count graph");
					}
				} else if (data && data.length === 0) {
                	// No subscription info found
					console.error("Invalid month batch count graph");
                }
			}

		    function updateMyAccount() {
		        
		    	var vPtbNm        = $("#managerName").val();
		    	var vPtbDeptNm    = $("#managerTeam").val();
		    	var vPtbPhNo      = $("#managerPhone").val();
		    	var vPtbEmail     = $("#managerEmail").val();
		    	var vUsrPassword  = $("#usrPassword").val();
		    	var vUsrPasswordAgain  = $("#usrPasswordAgain").val();
		    	
	    	
		    	if ( isNull(vPtbDeptNm) == "" ) {
		            alert("Enter your team name.");
		            $("#managerTeam").focus();
		    		return;
		    	}
		    	
		    	if ( isNull(vPtbPhNo) == "" ) {
		            alert("Enter your phone number.");
		            $("#managerPhone").focus();
		    		return;
		    	}

		    	if ( isNull(vUsrPassword) == "" ) {
		            alert("Enter your password.");
		            $("#usrPassword").focus();
		    		return;
		    	}

		    	if ( isNull(vUsrPasswordAgain) == "" ) {
		            alert("Re-enter your password.");
		            $("#usrPasswordAgain").focus();
		    		return;
		    	}
		    	
		    	if ( vUsrPassword != vUsrPasswordAgain ) {
		            alert("The two inputs for your password do not match. Please enter it again.");
		            $("#usrPasswordAgain").focus();
		    		return;
		    	}
	    	
		    	const myAccountData = {
		            ptbNm       : vPtbNm
		            , ptbDeptNm   : vPtbDeptNm
		            , ptbPhNo     : vPtbPhNo
		            , ptbEmail    : vPtbEmail
		            , usrPassword : vUsrPassword
		        };
		    		    
		    	var option = {
						id: "updateMyAccount"
						, type: "post"
						, url: "/mypage/updateMyAccount"
						, async: true
						, dataType: "json"
						, contentType: "application/json; charset=utf-8"
						, data: JSON.stringify(myAccountData), // JSON 문자열로 변환
					};

				gf_Transaction(option, fn_callback);
				
		    }			
		    
		</script>
	</th:block>
</html>
