<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
	<head>
		<meta charset="UTF-8">
		<title>파일업로드</title>
		<link rel="stylesheet" href="/js/slickgrid/dist/styles/css/slick.grid.css" type="text/css" />
		<link rel="stylesheet" href="/js/slickgrid/dist/styles/css/slick-alpine-theme.css" type="text/css" />
		<link rel="stylesheet" href="/css/jquery-ui-1.13.3/jquery-ui.css" type="text/css" />
		
		<!-- // tabler framework css files import -->
		<link href="/css/css-tabler/tabler.min.css?1692870487" rel="stylesheet" />
		<link href="/css/css-tabler/tabler-flags.min.css?1692870487" rel="stylesheet" />
		<link href="/css/css-tabler/tabler-payments.min.css?1692870487" rel="stylesheet" />
		<link href="/css/css-tabler/tabler-vendors.min.css?1692870487" rel="stylesheet" />
		<link href="/css/css-tabler/demo.min.css?1692870487" rel="stylesheet" />
		
		<!-- // custom css for this page -->
		<link href="/css/file-css.css" rel="stylesheet" />
		
		<script src="/js/jquery-3.7.1.min.js"></script>
		<script src="/js/slickgrid/lib/jquery.event.drag-2.3.0.js"></script>
		
		<script src="/js/slickgrid/dist/browser/slick.core.js"></script>
		<script src="/js/slickgrid/dist/browser/slick.interactions.js"></script>
		<script src="/js/slickgrid/dist/browser/slick.grid.js"></script>
		<script src="/js/slickgrid/dist/browser/plugins/slick.autotooltips.js"></script>
		<script src="/js/slickgrid/dist/browser/plugins/slick.cellrangedecorator.js"></script>
		<script src="/js/slickgrid/dist/browser/plugins/slick.cellrangeselector.js"></script>
		<script src="/js/slickgrid/dist/browser/plugins/slick.cellexternalcopymanager.js"></script>
		<script src="/js/slickgrid/dist/browser/plugins/slick.cellselectionmodel.js"></script>
		<script src="/js/slickgrid/dist/browser/slick.editors.js"></script>
		<script src="/js/slickgrid/dist/browser/slick.formatters.js"></script>

		<style>
			.slick-header-columns {
				/* flex-grow: 1 if we want to align sort icons to the right */
				--alpine-header-name-flex-grow: 1;
			}
			
			.slick-cell.copied {
				background: blue;
				background: rgba(0, 0, 255, 0.2);
				transition: 0.5s background;
			}
			/** override slick-cell to make it look like Excel sheet */
			.slick-container {
				--alpine-header-column-height: 20px;
				--alpine-header-font-weight: 500;
				--alpine-cell-border-width: 0 1px 1px 0;
				--alpine-cell-border-color: #d4d4d4;
			}
			
			/* main {
			        border: solid 0.5px #000000;
			        width: 1200px;
			        height: 700px;
				}
			
			    footer{
			        height: 30px;
			        margin: 2px;
			        border: solid 0.5px #000000;
			        background-color: #BFD8F2;
			    } */
			input::file-selector-button {
				font-weight: 500;
				color: rgb(255, 255, 255);
				padding: 3px;
				border: thin solid rgb(84, 85, 87);
				background-color: rgb(102, 115, 130);
				border-radius: 4px;
				transition: background-color 0.3s;
				font-size: 12px;
			}
			
			input::file-selector-button:hover {
				background-color: rgb(90, 90, 90);
			}
		</style>
		<script>
			$(document).ready( function() 
			                   {
			                        console.log("Document is ready.");
			                        $("input").on("keyup", function(key)
			                                               {
			                                                    if (key.keyCode == 13)
			                                                    {
			                                                         getSearchList();
			                                                    }
			                                               });
			                        // 파일관리화면의 조회부분 : TODO 공동으로 뺴놓기
			                        // MyBatis를 통해 데이터를 가져오는 AJAX 요청
			                        $.ajax({
			                            type: 'post',
			                            url: '/WRKFIL003M0SelectFileList',
			                            async: false,
			                            dataType: 'json',
			                            contentType: 'application/json; charset=utf-8',
			                            data: JSON.stringify({
			                                           uploadFile : ""
			                                         , stdYymm    : ""
			                                        }),
			                            success: function(response) {
			                                populateDropdown(response);
			                            },
			                            error: function(error) {
			                                console.error('Error fetching file names:', error);
			                            }
			                        });
			                    
			                        // DropDown 리스트에 FILE_NM 값을 추가하는 함수
			                        function populateDropdown(data) {
			                            var dropdown = $('#cmbUploadFileList');
			                            data.forEach(function(item) {
			                                var option = $('<option></option>').attr('value', item.seqNo).text(item.tblId+"("+item.fileNm+")");
			                                dropdown.append(option);
			                            });
			                        }
			                   });
			
			function getExcelList() 
			{
			     alert("Excel test");
			}
			
			function getSearchList() 
			{
			    console.log("Sending AJAX request...");
			    
			    const element = document.getElementById('divGrdMain');
			    element.innerHTML = '';
			    
			    $.ajax({
			             type       : 'post'
			           , url        : '/WRKFIL003M0SelectList'
			           , async      : true
			           , dataType   : 'json'
			           , contentType: 'application/json; charset=utf-8'
			           , data       : JSON.stringify({
			                                           uploadFile : $("#cmbUploadFileList").val()
			                                         , stdYymm    : $("#inpStdYymm").val()
			                                        })
			        
			           , success: function(data) 
			                      {
			                           console.log("AJAX request successful. Data received:", data);
			                           
			                           var grdData = data.data;
			                           var grdHead = data.grdHead;
			                           
			                           if (grdData && grdData.length > 0)
			                           {
			                                // 컬럼 생성
			                                var newRowIds = 0;
			                                var pluginOptions = {
			                                                        clipboardCommandHandler  : function(editCommand){ undoRedoBuffer.queueAndExecuteCommand.call(undoRedoBuffer,editCommand); }
			                                                      , readOnlyMode             : false
			                                                      , includeHeaderWhenCopying : false
			                                                      , newRowCreator            : function(count) 
			                                                                                   {
			                                                                                        for (var i = 0; i < count; i++) 
			                                                                                        {
			                                                                                            var item = { id: "newRow_" + newRowIds++ }
			                                                                                            grid.getData().addItem(item);
			                                                                                        }
			                                                                                    }
			                                                    };
			                                
			                                var columns = [];
			                                /*
			                                var keys    = Object.keys(grdData[0]);
			                                
			                                for (var i = 0; i < keys.length; i++)
			                                {
			                                    columns.push({ id: keys[i], name: keys[i], field: keys[i], sortable: true, editor: Slick.Editors.Text });
			                                }
			                                */
			                                
			                                for (var i = 0; i < grdHead.length; i++)
			                                {
			                                    
			                                    var sCd = grdHead[i].CD;
			                                    var sNm = grdHead[i].NM;
			                                    
			                                    columns.push({ id: sCd, name: sNm, field: sCd, sortable: true, editor: Slick.Editors.Text });
			                                }
			                                
			                                // 그리드 옵션
			                                var options = {
			                                                   enableCellNavigation       : true
			                                                 , enableColumnReorder        : false
			                                                 , forceFitColumns            : true
			                                                 , multiColumnSort            : true
			                                                 , numberedMultiColumnSort    : true
			                                                 , tristateMultiColumnSort    : true
			                                                 , sortColNumberInSeparateSpan: true
			                                                 , enableAutoSizeColumns      : true
			                                                 , editable                   : false
			                                                 , enableAddRow               : true
			                                                 , asyncEditorLoading         : false
			                                                 , autoEdit                   : false
			                                                 , autoEditNewRow             : false
			                                              };
			                                
			                                // 그리드 초기화 및 데이터 로드
			                                console.log("Initializing SlickGrid...");
			                                
			                                var grid = new Slick.Grid("#divGrdMain", grdData, columns, options);
			                                
			                                // when "onBeforeSort" returns false, the "onSort" won't execute (for example a backend server error while calling backend query to sort)
			                                grid.onBeforeSort.subscribe(function (e, args) 
			                                                            {
			                                                                 return true;
			                                                            });
			                                
			                                // 정렬
			                                grid.onSort.subscribe(function (e, args) 
			                                                      {
			                                                           var cols = args.sortCols;
			                                                           
			                                                           grdData.sort(function (dataRow1, dataRow2) 
			                                                                     {
			                                                                          for (var i = 0, l = cols.length; i < l; i++) 
			                                                                          {
			                                                                               var field  = cols[i].sortCol.field;
			                                                                               var sign   = cols[i].sortAsc ? 1 : -1;
			                                                                               var value1 = dataRow1[field], value2 = dataRow2[field];
			                                                                               var result = (value1 == value2 ? 0 : (value1 > value2 ? 1 : -1)) * sign;
			                                                                               if (result != 0) 
			                                                                               {
			                                                                                    return result;
			                                                                               }
			                                                                           }
			                                                                           return 0;
			                                                                     });
			                                                           grid.invalidate();
			                                                           grid.render();
			                                                      });
			                                
			                                grid.setSelectionModel(new Slick.CellSelectionModel());
			                                grid.registerPlugin(new Slick.AutoTooltips());
			                                
			                                // set keyboard focus on the grid
			                                grid.getCanvasNode().focus();
			                                
			                                grid.registerPlugin(new Slick.CellExternalCopyManager(pluginOptions));
			                                
			                                grid.onAddNewRow.subscribe(function (e, args) 
			                                                           {
			                                                                var item   = args.item;
			                                                                var column = args.column;
			                                                                grid.invalidateRow(grdData.length);
			                                                                grdData.push(item);
			                                                                grid.updateRowCount();
			                                                                grid.render();
			                                                           });
			                                
			                                console.log("SlickGrid initialized.");
			                           }
			                           else
			                           {
			                                console.log("No data returned from the server.");
			                           }
			                      }
			           , error: function(xhr, status, error) 
			                    {
			                        console.error("!!!! ERROR !!!!!", status, error);
			                    }
			    });
			}
			function setSaveUploadFile() 
			{
			    console.log("Sending AJAX request...");
			    
			    //let form = $('#uploadFrm')[0];
			    //let frmData = new FormData(form);
			    
			    var formData = new FormData();
			    var inputFile = $("input[name='btnFileUpload']");
			    var files = inputFile[0].files;
			    console.log(files);
			    
			    for(var i =0;i<files.length;i++){
			        
			        formData.append("uploadFile", files[i]);
			    }
			    
			    formData.append("param", new Blob([JSON.stringify({
			                                                        uploadFile : $("#cmbUploadFileList").val()
			                                                      , stdYymm    : $("#inpStdYymm").val()
			                                                      })], {type: "application/json"}))
			
			    $.ajax({
			        //enctype: 'multipart/form-data',
			        //contentType: 'multipart/form-data; charset=utf-8',
			        type: 'POST',
			        url        : '/WRKFIL003M0SaveUploadFile',
			        processData: false,   
			        contentType: false,
			        cache: false,
			        //file: files,
			        data: formData,
			        success: function(data) {
			            console.log(data);
			            
			            alert('파일업로드 저장 성공');
			            
			            var agent = navigator.userAgent.toLowerCase();
			            //파일초기화
			            if ( (navigator.appName == 'Netscape' && navigator.userAgent.search('Trident') != -1) 
			                 || (agent.indexOf("msie") != -1) ) {
			                $("#btnFileUpload").replaceWith($("#btnFileUpload").clone(true));
			            } else {
			                $("#btnFileUpload").val("");
			            }
			            
			            getSearchList();
			        },
			        error: function(e) {
			            console.log(e);
			            alert('파일업로드 저장 실패');
			        }
			    });
			    
			}
			
			function clearSlickGridData(){
			    var grid = new Slick.Grid("#divGrdMain", [{}], [{}], [{}]);
			}
		
		    </script>

</head>
<!---------- header,left (시작) -------------->
<header align="">
	<!-- <b>File Management System(Extract,Load,View)</b>
	<img height="60" src="./img/img_charater.png" align="right"> -->
</header>
	<body>
		<div class="page">
			<aside class="navbar navbar-vertical navbar-expand-lg" data-bs-theme="dark">
				<div class="container-fluid" style="background-color: rgb(0, 37, 171)">
					<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#sidebar-menu" aria-controls="sidebar-menu" aria-expanded="false" aria-label="Toggle navigation">
						<span class="navbar-toggler-icon"></span>
					</button>
					<h1 class="navbar-brand navbar-brand-autodark">
						<a href="."> <!-- <img
	                src="./static/iframe.svg"
	                width="110"
	                height="32"
	                alt="iframe"
	                class="navbar-brand-image"
	              /> --> iFrame 2.0
						</a>
					</h1>
					<div class="navbar-nav flex-row d-lg-none">
						<div class="nav-item d-none d-lg-flex me-3">
							<div class="btn-list">
								<a href="https://github.com/tabler/tabler" class="btn" target="_blank" rel="noreferrer"> <!-- Download SVG icon from http://tabler-icons.io/i/brand-github --> <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
	                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
	                    <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
	                  </svg> Source code
								</a> <a href="https://github.com/sponsors/codecalm" class="btn" target="_blank" rel="noreferrer"> <!-- Download SVG icon from http://tabler-icons.io/i/heart --> <svg xmlns="http://www.w3.org/2000/svg" class="icon text-pink" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
	                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
	                    <path d="M19.5 12.572l-7.5 7.428l-7.5 -7.428a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572" />
	                  </svg> Sponsor
								</a>
							</div>
						</div>
						<div class="d-none d-lg-flex">
							<a href="?theme=dark" class="nav-link px-0 hide-theme-dark" title="Enable dark mode" data-bs-toggle="tooltip" data-bs-placement="bottom"> <!-- Download SVG icon from http://tabler-icons.io/i/moon --> <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
	                  <path stroke="none" d="M0 0h24v24H0z" fill="none" />
	                  <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
	                </svg>
							</a> <a href="?theme=light" class="nav-link px-0 hide-theme-light" title="Enable light mode" data-bs-toggle="tooltip" data-bs-placement="bottom"> <!-- Download SVG icon from http://tabler-icons.io/i/sun --> <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
	                  <path stroke="none" d="M0 0h24v24H0z" fill="none" />
	                  <path d="M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0" />
	                  <path d="M3 12h1m8 -9v1m8 8h1m-9 8v1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7" />
	                </svg>
							</a>
							<div class="nav-item dropdown d-none d-md-flex me-3">
								<a href="#" class="nav-link px-0" data-bs-toggle="dropdown" tabindex="-1" aria-label="Show notifications"> <!-- Download SVG icon from http://tabler-icons.io/i/bell --> <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
	                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
	                    <path d="M10 5a2 2 0 1 1 4 0a7 7 0 0 1 4 6v3a4 4 0 0 0 2 3h-16a4 4 0 0 0 2 -3v-3a7 7 0 0 1 4 -6" />
	                    <path d="M9 17v1a3 3 0 0 0 6 0v-1" />
	                  </svg> <span class="badge bg-red"></span>
								</a>
								<div class="dropdown-menu dropdown-menu-arrow dropdown-menu-end dropdown-menu-card">
									<div class="card">
										<div class="card-header">
											<h3 class="card-title">Last updates</h3>
										</div>
										<div class="list-group list-group-flush list-group-hoverable">
											<div class="list-group-item">
												<div class="row align-items-center">
													<div class="col-auto">
														<span class="status-dot status-dot-animated bg-red d-block"></span>
													</div>
													<div class="col text-truncate">
														<a href="#" class="text-body d-block">Example 1</a>
														<div class="d-block text-secondary text-truncate mt-n1">Change deprecated html tags to text decoration classes (#29604)</div>
													</div>
													<div class="col-auto">
														<a href="#" class="list-group-item-actions"> <!-- Download SVG icon from http://tabler-icons.io/i/star --> <svg xmlns="http://www.w3.org/2000/svg" class="icon text-muted" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
	                                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
	                                <path d="M12 17.75l-6.172 3.245l1.179 -6.873l-5 -4.867l6.9 -1l3.086 -6.253l3.086 6.253l6.9 1l-5 4.867l1.179 6.873z" />
	                              </svg>
														</a>
													</div>
												</div>
											</div>
											<div class="list-group-item">
												<div class="row align-items-center">
													<div class="col-auto">
														<span class="status-dot d-block"></span>
													</div>
													<div class="col text-truncate">
														<a href="#" class="text-body d-block">Example 2</a>
														<div class="d-block text-secondary text-truncate mt-n1">justify-content:between ⇒ justify-content:space-between (#29734)</div>
													</div>
													<div class="col-auto">
														<a href="#" class="list-group-item-actions show"> <!-- Download SVG icon from http://tabler-icons.io/i/star --> <svg xmlns="http://www.w3.org/2000/svg" class="icon text-yellow" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
	                                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
	                                <path d="M12 17.75l-6.172 3.245l1.179 -6.873l-5 -4.867l6.9 -1l3.086 -6.253l3.086 6.253l6.9 1l-5 4.867l1.179 6.873z" />
	                              </svg>
														</a>
													</div>
												</div>
											</div>
											<div class="list-group-item">
												<div class="row align-items-center">
													<div class="col-auto">
														<span class="status-dot d-block"></span>
													</div>
													<div class="col text-truncate">
														<a href="#" class="text-body d-block">Example 3</a>
														<div class="d-block text-secondary text-truncate mt-n1">Update change-version.js (#29736)</div>
													</div>
													<div class="col-auto">
														<a href="#" class="list-group-item-actions"> <!-- Download SVG icon from http://tabler-icons.io/i/star --> <svg xmlns="http://www.w3.org/2000/svg" class="icon text-muted" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
	                                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
	                                <path d="M12 17.75l-6.172 3.245l1.179 -6.873l-5 -4.867l6.9 -1l3.086 -6.253l3.086 6.253l6.9 1l-5 4.867l1.179 6.873z" />
	                              </svg>
														</a>
													</div>
												</div>
											</div>
											<div class="list-group-item">
												<div class="row align-items-center">
													<div class="col-auto">
														<span class="status-dot status-dot-animated bg-green d-block"></span>
													</div>
													<div class="col text-truncate">
														<a href="#" class="text-body d-block">Example 4</a>
														<div class="d-block text-secondary text-truncate mt-n1">Regenerate package-lock.json (#29730)</div>
													</div>
													<div class="col-auto">
														<a href="#" class="list-group-item-actions"> <!-- Download SVG icon from http://tabler-icons.io/i/star --> <svg xmlns="http://www.w3.org/2000/svg" class="icon text-muted" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
	                                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
	                                <path d="M12 17.75l-6.172 3.245l1.179 -6.873l-5 -4.867l6.9 -1l3.086 -6.253l3.086 6.253l6.9 1l-5 4.867l1.179 6.873z" />
	                              </svg>
														</a>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="nav-item dropdown">
							<a href="#" class="nav-link d-flex lh-1 text-reset p-0" data-bs-toggle="dropdown" aria-label="Open user menu"> <span class="avatar avatar-sm" style="background-image: url(./static/avatars/000m.jpg)"></span>
								<div class="d-none d-xl-block ps-2">
									<div>Paweł Kuna</div>
									<div class="mt-1 small text-secondary">UI Designer</div>
								</div>
							</a>
							<div class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
								<a href="#" class="dropdown-item">Status</a> <a href="./profile.html" class="dropdown-item">Profile</a> <a href="#" class="dropdown-item">Feedback</a>
								<div class="dropdown-divider"></div>
								<a href="./settings.html" class="dropdown-item">Settings</a> <a href="./sign-in.html" class="dropdown-item">Logout</a>
							</div>
						</div>
					</div>
					<div class="collapse navbar-collapse" id="sidebar-menu">
						<ul class="navbar-nav pt-lg-3">
							<li class="nav-item"><a class="nav-link" href="WRK/FIL/WRKFIL001M0.html"> <!-- <a class="dropdown-item" href="./alert.html"> </a> --> <span class="nav-link-icon d-md-none d-lg-inline-block">
										<!-- Download SVG icon from http://tabler-icons.io/i/home --> <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
	                          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
	                          <path d="M5 12l-2 0l9 -9l9 9l-2 0" />
	                          <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
	                          <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
	                        </svg>
								</span> <!-- <span class="nav-link-title"> Home</span> --> Home
							</a></li>
	
							<li class="nav-item"><a class="nav-link" href="#" data-section="layout-sample2.html"> <!-- <a class="dropdown-item" href="./alert.html"> </a> --> <span class="nav-link-icon d-md-none d-lg-inline-block">
										<!-- Download SVG icon from http://tabler-icons.io/i/home --> <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
	                          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
	                          <path d="M5 12l-2 0l9 -9l9 9l-2 0" />
	                          <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
	                          <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
	                        </svg>
								</span> <!-- <span class="nav-link-title"> Home</span> --> File
							</a></li>
							<li class="nav-item"><a class="nav-link" href="./layout-boxed.html"> <!-- <a class="dropdown-item" href="./alert.html"> </a> --> <span class="nav-link-icon d-md-none d-lg-inline-block">
										<!-- Download SVG icon from http://tabler-icons.io/i/home --> <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
	                          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
	                          <path d="M5 12l-2 0l9 -9l9 9l-2 0" />
	                          <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
	                          <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
	                        </svg>
								</span> <!-- <span class="nav-link-title"> Home</span> --> Column
							</a></li>
							<li class="nav-item"><a class="nav-link" href="./layout-combo.html"> <!-- <a class="dropdown-item" href="./alert.html"> </a> --> <span class="nav-link-icon d-md-none d-lg-inline-block">
										<!-- Download SVG icon from http://tabler-icons.io/i/home --> <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
	                          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
	                          <path d="M5 12l-2 0l9 -9l9 9l-2 0" />
	                          <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
	                          <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
	                        </svg>
								</span> <!-- <span class="nav-link-title"> Home</span> --> Upload
							</a></li>
							<li class="nav-item"><a class="nav-link" href="./layout-dashboard.html"> <!-- <a class="dropdown-item" href="./alert.html"> </a> --> <span class="nav-link-icon d-md-none d-lg-inline-block">
										<!-- Download SVG icon from http://tabler-icons.io/i/home --> <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
	                          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
	                          <path d="M5 12l-2 0l9 -9l9 9l-2 0" />
	                          <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
	                          <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
	                        </svg>
								</span> <!-- <span class="nav-link-title"> Home</span> --> History
							</a></li>
							<li class="nav-item"><a class="nav-link" href="./sign-in-cover.html"> <!-- <a class="dropdown-item" href="./alert.html"> </a> --> <span class="nav-link-icon d-md-none d-lg-inline-block">
										<!-- Download SVG icon from http://tabler-icons.io/i/home --> <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
	                          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
	                          <path d="M5 12l-2 0l9 -9l9 9l-2 0" />
	                          <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
	                          <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
	                        </svg>
								</span> <!-- <span class="nav-link-title"> Home</span> --> Job List
							</a></li>
							<li class="nav-item"><a class="nav-link" href="./layout-dashboard.html"> <!-- <a class="dropdown-item" href="./alert.html"> </a> --> <span class="nav-link-icon d-md-none d-lg-inline-block">
										<!-- Download SVG icon from http://tabler-icons.io/i/home --> <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
	                          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
	                          <path d="M5 12l-2 0l9 -9l9 9l-2 0" />
	                          <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
	                          <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
	                        </svg>
								</span> <!-- <span class="nav-link-title"> Home</span> --> Job Runs
							</a></li>
							<li class="nav-item"><a class="nav-link" href="./layout-dashboard.html"> <!-- <a class="dropdown-item" href="./alert.html"> </a> --> <span class="nav-link-icon d-md-none d-lg-inline-block">
										<!-- Download SVG icon from http://tabler-icons.io/i/home --> <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
	                          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
	                          <path d="M5 12l-2 0l9 -9l9 9l-2 0" />
	                          <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
	                          <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
	                        </svg>
								</span> <!-- <span class="nav-link-title"> Home</span> --> Job Result
							</a></li>
							<li class="nav-item"><a class="nav-link" href="./layout-dashboard.html"> <!-- <a class="dropdown-item" href="./alert.html"> </a> --> <span class="nav-link-icon d-md-none d-lg-inline-block">
										<!-- Download SVG icon from http://tabler-icons.io/i/home --> <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
	                          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
	                          <path d="M5 12l-2 0l9 -9l9 9l-2 0" />
	                          <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
	                          <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
	                        </svg>
								</span> <!-- <span class="nav-link-title"> Home</span> --> Account Code
							</a></li>
							<li class="nav-item"><a class="nav-link" href="./layout-dashboard.html"> <!-- <a class="dropdown-item" href="./alert.html"> </a> --> <span class="nav-link-icon d-md-none d-lg-inline-block">
										<!-- Download SVG icon from http://tabler-icons.io/i/home --> <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
	                          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
	                          <path d="M5 12l-2 0l9 -9l9 9l-2 0" />
	                          <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
	                          <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
	                        </svg>
								</span> <!-- <span class="nav-link-title"> Home</span> --> Journal Rules
							</a></li>
							<li class="nav-item"><a class="nav-link" href="./layout-dashboard.html"> <!-- <a class="dropdown-item" href="./alert.html"> </a> --> <span class="nav-link-icon d-md-none d-lg-inline-block">
										<!-- Download SVG icon from http://tabler-icons.io/i/home --> <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
	                          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
	                          <path d="M5 12l-2 0l9 -9l9 9l-2 0" />
	                          <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
	                          <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
	                        </svg>
								</span> <!-- <span class="nav-link-title"> Home</span> --> Journal Result
							</a></li>
							<li class="nav-item"><a class="nav-link" href="./layout-dashboard.html"> <!-- <a class="dropdown-item" href="./alert.html"> </a> --> <span class="nav-link-icon d-md-none d-lg-inline-block">
										<!-- Download SVG icon from http://tabler-icons.io/i/home --> <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
	                          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
	                          <path d="M5 12l-2 0l9 -9l9 9l-2 0" />
	                          <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
	                          <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
	                        </svg>
								</span> <!-- <span class="nav-link-title"> Home</span> --> Insurance Summary
							</a></li>
							<li class="nav-item"><a class="nav-link" href="./layout-dashboard.html"> <!-- <a class="dropdown-item" href="./alert.html"> </a> --> <span class="nav-link-icon d-md-none d-lg-inline-block">
										<!-- Download SVG icon from http://tabler-icons.io/i/home --> <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
	                          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
	                          <path d="M5 12l-2 0l9 -9l9 9l-2 0" />
	                          <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
	                          <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
	                        </svg>
								</span> <!-- <span class="nav-link-title"> Home</span> --> Financial Statement
							</a></li>
							<li class="nav-item"><a class="nav-link" href="./layout-dashboard.html"> <!-- <a class="dropdown-item" href="./alert.html"> </a> --> <span class="nav-link-icon d-md-none d-lg-inline-block">
										<!-- Download SVG icon from http://tabler-icons.io/i/home --> <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
	                          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
	                          <path d="M5 12l-2 0l9 -9l9 9l-2 0" />
	                          <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
	                          <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
	                        </svg>
								</span> <!-- <span class="nav-link-title"> Home</span> --> Audit Log
							</a></li>
							<li class="nav-item"><a class="nav-link" href="./layout-dashboard.html"> <!-- <a class="dropdown-item" href="./alert.html"> </a> --> <span class="nav-link-icon d-md-none d-lg-inline-block">
										<!-- Download SVG icon from http://tabler-icons.io/i/home --> <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
	                          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
	                          <path d="M5 12l-2 0l9 -9l9 9l-2 0" />
	                          <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
	                          <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
	                        </svg>
								</span> <!-- <span class="nav-link-title"> Home</span> --> Users
							</a></li>
							<li class="nav-item"><a class="nav-link" href="./layout-dashboard.html"> <!-- <a class="dropdown-item" href="./alert.html"> </a> --> <span class="nav-link-icon d-md-none d-lg-inline-block">
										<!-- Download SVG icon from http://tabler-icons.io/i/home --> <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
	                          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
	                          <path d="M5 12l-2 0l9 -9l9 9l-2 0" />
	                          <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
	                          <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
	                        </svg>
								</span> <!-- <span class="nav-link-title"> Home</span> --> Code
							</a></li>
							<li class="nav-item"><a class="nav-link" href="./layout-dashboard.html"> <!-- <a class="dropdown-item" href="./alert.html"> </a> --> <span class="nav-link-icon d-md-none d-lg-inline-block">
										<!-- Download SVG icon from http://tabler-icons.io/i/home --> <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
	                          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
	                          <path d="M5 12l-2 0l9 -9l9 9l-2 0" />
	                          <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
	                          <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
	                        </svg>
								</span> <!-- <span class="nav-link-title"> Home</span> --> Services
							</a></li>
							<li class="nav-item"><a class="nav-link" href="./layout-dashboard.html"> <!-- <a class="dropdown-item" href="./alert.html"> </a> --> <span class="nav-link-icon d-md-none d-lg-inline-block">
										<!-- Download SVG icon from http://tabler-icons.io/i/home --> <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
	                          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
	                          <path d="M5 12l-2 0l9 -9l9 9l-2 0" />
	                          <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
	                          <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
	                        </svg>
								</span> <!-- <span class="nav-link-title"> Home</span> --> Company
							</a></li>
							<li class="nav-item"><a class="nav-link" href="./layout-dashboard.html"> <!-- <a class="dropdown-item" href="./alert.html"> </a> --> <span class="nav-link-icon d-md-none d-lg-inline-block">
										<!-- Download SVG icon from http://tabler-icons.io/i/home --> <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
	                          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
	                          <path d="M5 12l-2 0l9 -9l9 9l-2 0" />
	                          <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
	                          <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
	                        </svg>
								</span> <!-- <span class="nav-link-title"> Home</span> --> Users
							</a></li>
							<li class="nav-item"><a class="nav-link" href="./layout-dashboard.html"> <!-- <a class="dropdown-item" href="./alert.html"> </a> --> <span class="nav-link-icon d-md-none d-lg-inline-block">
										<!-- Download SVG icon from http://tabler-icons.io/i/home --> <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
	                          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
	                          <path d="M5 12l-2 0l9 -9l9 9l-2 0" />
	                          <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
	                          <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
	                        </svg>
								</span> <!-- <span class="nav-link-title"> Home</span> --> Services
							</a></li>
							<div class="dropdown-menu">
								<a class="dropdown-item" href="https://tabler.io/docs" target="_blank" rel="noopener"> Documentation </a> <a class="dropdown-item" href="./changelog.html"> Changelog </a> <a class="dropdown-item" href="https://github.com/tabler/tabler" target="_blank" rel="noopener"> Source code </a> <a class="dropdown-item text-pink" href="https://github.com/sponsors/codecalm" target="_blank" rel="noopener"> <!-- Download SVG icon from http://tabler-icons.io/i/heart --> <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-inline me-1" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
	                      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
	                      <path d="M19.5 12.572l-7.5 7.428l-7.5 -7.428a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572" />
	                    </svg> Sponsor project!
								</a>
							</div>
							</li>
						</ul>
					</div>
				</div>
			</aside>
			<script src="/js/js-tabler/demo-theme.min.js?1692870487"></script>
			<div class="page-wrapper" id="page-wrapper">
				<div class="container" id="'container">
					<h2>File Upload</h2>
					<div class="ptag-container">
						<span><a href="#"> Home ></a></span> <span><a href="#"> File Upload</a></span>
						<div class="form-container">
							<div class="form-box">
								<form id="divSearch" name="divSearch" method="post" action="/WRKFIL001M0SelectList" onsubmit="return false;">
									<div class="row">
										<div class="col">
											<label for="fileDropdown" class="form-label"> Year / Month:</label>
											<!-- <input id="inpStdYymm" name="inpStdYymm" required="required" type="text" /> -->
											<input id="inpStdYymm" name="inpStdYymm" type="text" class="form-control" required="required" style="padding: 3px" />
										</div>
										<div class="col">
											<div class="col">
												<label for="lblUploadFileList" class="form-label">File upload : </label>
												<select id="cmbUploadFileList" name="cmbUploadFileList" required="required" class="form-select">
													<option selected="selected" value="">- select -</option>
												</select>
											</div>
										</div>
										<!-- <div class="col">
	                                            <label class="form-label"></label>
	                                            <form method="post" id="uploadFrm" enctype="multipart/form-data">
	                                                <input 
	                                                    id="btnFileUpload" 
	                                                    name="btnFileUpload" 
	                                                    type="file" 
	                                                    value="파일선택" 
	                                                    accept=".xlsx, .xls"
	                                                    style="
	                                                        font-size: 13px"
	                                                />
	                                            </form>
	                                          </div> -->
										<div class="col"></div>
										<div class="col"></div>
									</div>
									<div class="row mt-3">
										<div class="col">
											<form method="post" id="uploadFrm" enctype="multipart/form-data">
												<input id="btnFileUpload" name="btnFileUpload" type="file" value="파일선택" accept=".xlsx, .xls" style="font-size: 13px" />
											</form>
										</div>
										<div class="col text-end">
											<button name="btnSearch" type="button" class=" btn btn-primary" style="padding: 4px 10px; color: white; font-size: 13px;" onclick="getSearchList()" data-test="create-button">Search</button>
											<button name="btnExcelDown" type="button" class="btn btn-lime" style="padding: 4px 10px; color: white; font-size: 13px;" id="downloadExcel" onclick="getExcelList()" data-test="edit-button">Download</button>
	
											<button name="btnSave" type="button" class=" btn btn-secondary" style="padding: 4px 10px; color: white; font-size: 13px;" onclick="setSaveUploadFile()" data-test="edit-button">Save</button>
										</div>
									</div>
							</div>
							<div class="row mt-3"></div>
							</form>
						</div>
						<div style="padding-top: 2em">
							<form name="divData">
								<p>
									►&nbsp;<label for="lblGrdTitle">Grid title: </label>
								</p>
	
								<table align="center" border="1" cellpadding="1" cellspacing="1" style="width: 500px">
									<div id="divGrdMain" style="width: 600px; height: 600px;"></div>
								</table>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>
		</div>
	
	</body>
</html>
