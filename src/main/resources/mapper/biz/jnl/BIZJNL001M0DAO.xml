<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTO Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.rds.adams.web.biz.jnl.dao.BIZJNL001M0DAO">
    <select id="selectList" parameterType="com.rds.adams.web.biz.jnl.dto.BIZJNL001M0P0DTO" resultType="com.rds.adams.web.biz.jnl.dto.BIZJNL001M0R0DTO">	
		SELECT
				ROW_NUMBER() OVER(ORDER BY (SELECT 1)) AS ROW_NUMBER
             , A.ATIT_CD                               AS atitCd
             , A.ATIT_KOR_NM                           AS atitKorNm
             , A.ATIT_ENG_NM                           AS atitEngNm
             , A.HGRK_ATIT_CD                          AS hgrkAtitCd
             , A.AC_LVL_CD                             AS acLvlCd       
             , A.BKG_AC_YN                             AS bkgAcYn
             , A.FS_DV_CD                              AS fsDvCd
             , A.AC_DV_CD                              AS acDvCd
             , A.AC_KIND_CD                            AS acKindCd
             , CONVERT(CHAR(10), CONVERT(DATE, A.APP_ST_DT, 112), 23)    AS appStDt
             , CONVERT(CHAR(10), CONVERT(DATE, A.APP_ED_DT, 112), 23)       AS appEdDt
             , A.ORD_SEQ                               AS ordSeq
             , A.ETC_DESC                              AS etcDesc
             , A.USE_YN                                AS useYn
             , B.USR_NM                                AS frstRegEmpNo
             , A.FRST_REG_DTM                          AS frstRegDtm
		  FROM TB_ATIT_MNG_LST A 
		  LEFT OUTER JOIN TB_USR_MNG_LST B 
          ON A.FNL_UPD_EMP_NO = B.USR_ID
		 WHERE 1=1
		   AND A.APP_ST_DT IS NOT NULL
		   AND A.APP_ED_DT IS NOT NULL
		<if test= 'csNo != "999"'>	
			AND A.CS_NO        = #{csNo}
		</if>
		<if test='searchTxt != ""'>
			AND (
					A.ATIT_CD     LIKE '%' + #{searchTxt} + '%'
				OR  A.ATIT_KOR_NM LIKE '%' + #{searchTxt} + '%'
				OR  A.ATIT_ENG_NM LIKE '%' + #{searchTxt} + '%'
				)
		</if>
	</select>
	<insert id="insertList" parameterType="com.rds.adams.web.biz.jnl.dto.BIZJNL001M0P1DTO">
		INSERT INTO [dbo].[TB_ATIT_MNG_LST] (
			  [CS_NO]
			, [ATIT_CD]
			, [ATIT_KOR_NM]
			, [ATIT_ENG_NM]
			, [HGRK_ATIT_CD]
			, [AC_LVL_CD]
			, [BKG_AC_YN]
			, [FS_DV_CD]
			, [AC_DV_CD]
			, [AC_KIND_CD]
			, [APP_ST_DT]
			, [APP_ED_DT]
			, [ORD_SEQ]
			, [ETC_DESC]
			, [USE_YN]
			, [FRST_REG_EMP_NO]
		    , [FRST_REG_DTM]
			, [FNL_UPD_EMP_NO]
			, [FNL_UPD_DTM]
        )
        VALUES (
			  #{csNo}
			, #{atitCd}
            , #{atitKorNm}
            , #{atitEngNm}
            , #{hgrkAtitCd}
            , #{acLvlCd}
            , #{bkgAcYn}
            , #{fsDvCd}
            , #{acDvCd}
            , #{acKindCd}
            , REPLACE(#{appStDt}, '-', '')
            , REPLACE(#{appEdDt}, '-', '')
            , #{ordSeq}
            , #{etcDesc}
            , #{useYn}
			, #{frstRegEmpNo}
            , CONVERT(CHAR(10), getdate(), 23)
            , #{frstRegEmpNo}
            , CONVERT(CHAR(10), getdate(), 23)
        )
    </insert>
    <update id="updateList" parameterType="com.rds.adams.web.biz.jnl.dto.BIZJNL001M0P1DTO">
        UPDATE TB_ATIT_MNG_LST
           SET 
               ATIT_KOR_NM = #{atitKorNm},
               ATIT_ENG_NM = #{atitEngNm},
               HGRK_ATIT_CD = #{hgrkAtitCd},
               AC_LVL_CD = #{acLvlCd},
               BKG_AC_YN = #{bkgAcYn},
               FS_DV_CD = #{fsDvCd},
               AC_DV_CD = #{acDvCd},
			   AC_KIND_CD = #{acKindCd},
			   APP_ST_DT = REPLACE(#{appStDt}, '-', ''),
			   APP_ED_DT = REPLACE(#{appEdDt}, '-', ''),
			   ORD_SEQ = #{ordSeq},
			   ETC_DESC = #{etcDesc},
               USE_YN = #{useYn},
               FNL_UPD_EMP_NO = #{frstRegEmpNo},
               FNL_UPD_DTM    = CONVERT(CHAR(10), getdate(), 23)
         WHERE 1=1
           AND ATIT_CD = #{atitCd}
           AND CS_NO   = #{csNo}
  </update>
    <delete id="deleteList" parameterType="com.rds.adams.web.biz.jnl.dto.BIZJNL001M0P1DTO">
		DELETE FROM TB_ATIT_MNG_LST
		WHERE 1=1
		  AND ATIT_CD = #{atitCd}
		  AND CS_NO   = #{csNo}
	</delete>
</mapper>