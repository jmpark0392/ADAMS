<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTO Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.rds.adams.web.wrk.fil.dao.WRKFIL001M0DAO">
    <select id="selectList" parameterType="com.rds.adams.web.wrk.fil.dto.WRKFIL001M0P0DTO" resultType="com.rds.adams.web.wrk.fil.dto.WRKFIL001M0R0DTO">
		SELECT
		       SEQ_NO
		     , FILE_NM
		     , DB_ID
		     , TBL_ID
		     , FILE_DSC
		     , FILE_DEL_YN
		     , UI_SEL_YN
		     , USE_YN
		     , VRF_USE_YN
		     , REG_USRID
		     , REG_DT
		  FROM TB_UPL_FILE_LST
         WHERE 1=1
         <if test='searchTxt != ""'>
           AND (
                   FILE_NM  LIKE CONCAT_WS('%', #{searchTxt}, '%')
                OR TBL_ID   LIKE CONCAT_WS('%', #{searchTxt}, '%')
                )
         </if>
    </select>
    <insert id="insertList" parameterType="com.rds.adams.web.wrk.fil.dto.WRKFIL001M0P1DTO">
        <selectKey resultType="int" keyProperty="seqNo" order="BEFORE">
            SELECT MAX(SEQ_NO)+1 FROM TB_UPL_FILE_LST;
        </selectKey>
        INSERT INTO [dbo].[TB_UPL_FILE_LST] (
            [SEQ_NO],
            [DB_ID],
            [TBL_ID],
            [FILE_NM],
            [FILE_DSC],
            [FILE_DEL_YN],
            [UI_SEL_YN],
            [USE_YN],
            [VRF_USE_YN],
            [REG_USRID],
            [REG_DT],
            [UPD_USRID],
            [UPD_DT]
        )
        VALUES (
            #{seqNo},
            #{dbId},
            #{tblId},
            #{fileNm},
            #{fileDsc},
            #{fileDelYn},
            #{uiSelYn},
            #{useYn},
            #{vrfUseYn},
            'admin',
            CONVERT(CHAR(10), getdate(), 23),
            'admin',
            CONVERT(CHAR(10), getdate(), 23)
        )
    </insert>
    <update id="updateList" parameterType="com.rds.adams.web.wrk.fil.dto.WRKFIL001M0P1DTO">
        UPDATE TB_UPL_FILE_LST
           SET DB_ID = #{dbId},
               TBL_ID = #{tblId},
               FILE_NM = #{fileNm},
               FILE_DSC = #{fileDsc},
               FILE_DEL_YN = #{fileDelYn},
               UI_SEL_YN = #{uiSelYn},
               USE_YN = #{useYn},
               VRF_USE_YN = #{vrfUseYn},
               UPD_USRID = 'admin',
               UPD_DT = CONVERT(CHAR(10), getdate(), 23)
         WHERE SEQ_NO = #{seqNo}
    </update>
</mapper>